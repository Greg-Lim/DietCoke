
import fastapi
from fastapi import UploadFile, File, Form
from PIL import Image

# fastapi dev benchmarks/DietCoke/python/lavis_serve_free.py --port 8090

app = fastapi.FastAPI()

@app.get("/")
def read_root():
    return {"Hello": "World"}


@app.post("/generate_caption_qa")
async def generate_caption_qa(file: UploadFile = File(...), question: str = Form(...)):
    return {'image': {}, 'text_input': ['what is behind the people in the image?'], 'gradcams': {}, 'captions': [['seven people are smiling sitting around a small group', 'a group of young people standing around a globe', 'four people and a man are laughing together', 'three young adults sitting around a map that is on a map map', 'a smiling classroom teacher with many high school students', 'a very funny group of people in front of a giant globe', 'this group shows off their work by smiling', 'a group of children are sitting and laughing together', 'a group of children and adults gather around a table', 'a teacher sits between a group of students who are smiling', 'a group a four generation of people gather around a brown table', 'a group of people sitting each other in a circle', 'a group of young people standing around each other', 'a female and some young people posing for a picture', 'there is a group of kids sitting around discussing about a piece of text', 'a group of children standing next to the face of one another', 'a group of students standing around a table and smiling', 'the students are sitting around a blackboard in front of a map', 'a small group of people smiling in a circle', 'a group of children having a class of an elementary class', 'a group of young students in a primary school', 'the children are sitting around a man and woman', 'a group of children gathered and drawing in order to make a map', 'a group of children laughing over a table', 'a group of school teenagers smiling around a table at a table', 'a group of people looking at something they are talking and laughing', 'a group of women are sitting together around a table on a blue surface', 'a group of young teenagers with a world map', 'a group of children drawing something on paper', 'the group of people is all enjoying writing a game', 'a group of friends sitting in front of a map laughing', 'five smiling students and two parents in a classroom', "several people sit around a smiling young man in a teacher's classroom", 'four young adults working with each other at a table', 'young boy is standing with her four classmates in front of a world map', 'a team of five people around each other in a room', 'a group of children are in a class meeting', 'a group of kids are standing in front of a globe map', 'a group of students smiling in a classroom', 'a teacher sitting at a meeting and teacher is talking to students', 'a group of people posing around a table together in a group', 'a group of people sitting around a woman making something out of something', 'a group of people sitting around a table', 'a group of children sit around a wooden table with a map behind them', 'a group of people posing for the camera near a board', 'some kids looking at a colorful wall with a map and a drawing', 'a group of children gather around a teacher', 'a group of young students sitting at a table talking', 'a group of young people around a table in a room', 'children working towards a paper project with the students sitting at a table']], 'questions': ['what are seven people smiling sitting around a small group?', 'how many people are smiling around a small group?', 'who are smiling around a small group?', 'who is sitting next to the face of one another?', 'how are seven people smiling around a small group?', 'who are sitting around a blackboard in front of a map?', 'what are the children and adults sitting around?', 'where are the children and adults sitting?', 'how old are the students in the group?', 'what are the students sitting around a blackboard in front of?', 'how are the students showing off their work?', 'where are the students standing?', 'how are the kids in front of the globe?', 'what are the students sitting around a blackboard in front of?', 'who sits between a group of students who are smiling?', 'how are the group of people sitting around a globe doing?', 'who is standing in front of a globe map?', 'how many young adults are working with each other at a table?', 'how are the children sitting around a table?', 'who sits around a map that is on a map map?', 'where are the students smiling?', 'what is the name of the group of people sitting around each other in a circle?', 'what are the group of people looking at?', 'what is the group of young people standing around?', 'who is standing around a globe?', 'what is the name of the man in the group?', 'where are the students smiling?', 'what does a group of children do around a teacher?', 'who sits between a group of students who are smiling?', 'what is the group doing around a table?', 'is there a group of people in front of a globe?'], 'answers': ['group.', 'a group.', 'people.', 'children.', 'sitting.', 'students.', 'table.', 'a table.', 'young.', 'map.', 'smiling.', 'front.', 'standing.', 'a map.', 'teacher.', 'laughing.', 'kids.', 'four.', 'together.', 'adults.', 'classroom.', 'other.', 'something.', 'globe.', 'young people.', 'man.', 'school.', 'gather.', 'a teacher.', 'posing.', 'yes.'], 'ans_to_cap_dict': {'seven': [0], 'people': [0, 1, 2, 5, 10, 11, 12, 13, 18, 25, 29, 32, 35, 40, 41, 42, 44, 48], 'smiling': [0, 4, 6, 9, 16, 18, 24, 31, 32, 38], 'sitting': [0, 3, 7, 11, 14, 17, 21, 26, 30, 39, 41, 42, 47, 49], 'small': [0, 18], 'group': [0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 36, 37, 38, 40, 41, 42, 43, 44, 46, 47, 48], 'seven people': [0], 'a small group': [0, 18], 'young': [1, 3, 12, 13, 20, 27, 32, 33, 34, 47, 48], 'standing': [1, 12, 15, 16, 34, 37], 'globe': [1, 5, 37], 'a group': [1, 7, 8, 9, 10, 11, 12, 14, 15, 16, 19, 20, 22, 23, 24, 25, 26, 27, 28, 30, 36, 37, 38, 40, 41, 42, 43, 44, 46, 47, 48], 'young people': [1, 12, 48], 'a globe': [1], 'four': [2, 10, 33, 34], 'man': [2, 21, 32], 'laughing': [2, 7, 23, 25, 30], 'together': [2, 7, 26, 40], 'four people': [2], 'a man': [2, 21], 'three': [3], 'adults': [3, 8, 33], 'map': [3, 17, 22, 27, 30, 34, 37, 43, 45], 'three young adults': [3], 'a map': [3, 17, 22, 30, 43, 45], 'that': [3], 'a map map': [3], 'classroom': [4, 31, 32, 38], 'teacher': [4, 9, 32, 39, 46], 'many': [4], 'high': [4], 'school': [4, 20, 24], 'students': [4, 9, 16, 17, 20, 31, 38, 39, 47, 49], 'very': [5], 'funny': [5], 'front': [5, 17, 30, 34, 37], 'giant': [5], 'a giant globe': [5], 'shows': [6], 'work': [6], 'this group': [6], 'their work': [6], 'children': [7, 8, 15, 19, 21, 22, 23, 28, 36, 43, 46, 49], 'gather': [8, 10, 46], 'table': [8, 10, 16, 23, 24, 26, 33, 40, 42, 43, 47, 48, 49], 'a table': [8, 16, 23, 24, 26, 33, 40, 42, 47, 48, 49], 'sits': [9], 'a teacher': [9, 39, 46], 'who': [9], 'generation': [10], 'brown': [10], 'a four generation': [10], 'a brown table': [10], 'other': [11, 12, 33, 35], 'circle': [11, 18], 'a circle': [11, 18], 'female': [13], 'posing': [13, 40, 44], 'picture': [13], 'some young people': [13], 'a picture': [13], 'is': [14], 'kids': [14, 37, 45], 'around': [14], 'discussing': [14], 'piece': [14], 'text': [14], 'a piece': [14], 'next': [15], 'face': [15], 'one': [15], 'the face': [15], 'blackboard': [17], 'the students': [17, 49], 'a blackboard': [17], 'having': [19], 'class': [19, 36], 'elementary': [19], 'a class': [19], 'an elementary class': [19], 'primary': [20], 'young students': [20, 47], 'a primary school': [20], 'woman': [21, 41], 'the children': [21], 'gathered': [22], 'drawing': [22, 28, 45], 'order': [22], 'make': [22], 'teenagers': [24, 27], 'school teenagers': [24], 'looking': [25, 45], 'talking': [25, 39, 47], 'something': [25, 28, 41], 'they': [25], 'women': [26], 'blue': [26], 'surface': [26], 'a blue surface': [26], 'world': [27, 34], 'young teenagers': [27], 'a world map': [27, 34], 'paper': [28, 49], 'enjoying': [29], 'writing': [29], 'game': [29], 'the group': [29], 'a game': [29], 'friends': [30], 'five': [31, 35], 'two': [31], 'parents': [31], 'five smiling students': [31], 'two parents': [31], 'a classroom': [31, 38], 'several': [32], 'sit': [32, 43], 'several people': [32], "a teacher's classroom": [32], 'working': [33, 49], 'four young adults': [33], 'boy': [34], 'classmates': [34], 'young boy': [34], 'her four classmates': [34], 'team': [35], 'room': [35, 48], 'a team': [35], 'five people': [35], 'a room': [35, 48], 'meeting': [36, 39], 'a class meeting': [36], 'a globe map': [37], 'a meeting': [39], 'making': [41], 'a woman': [41], 'wooden': [43], 'a wooden table': [43], 'them': [43], 'camera': [44], 'board': [44], 'the camera': [44], 'a board': [44], 'colorful': [45], 'wall': [45], 'some kids': [45], 'a colorful wall': [45], 'a drawing': [45], 'project': [49], 'a paper project': [49]}}